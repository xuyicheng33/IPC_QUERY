import{n as s}from"./urlState.js";const i="ipc_search_history",o="ipc_favorites";function c(r){return r==="pn"||r==="term"||r==="all"}function n(r,e){if(!r)return e;try{return JSON.parse(r)}catch{return e}}function g(){const r=n(window.localStorage.getItem(i),[]);return Array.isArray(r)?r.map(e=>{const t=e,a=c(t.match)?t.match:"pn";return{q:String(t.q||"").trim(),match:a,include_notes:!!t.include_notes,source_dir:s(String(t.source_dir||"")),source_pdf:String(t.source_pdf||"").trim(),ts:Number(t.ts||Date.now())}}).filter(e=>e.q):[]}function m(r){window.localStorage.setItem(i,JSON.stringify(r.slice(0,30)))}function d(){const r=n(window.localStorage.getItem(o),[]);return Array.isArray(r)?r.map(e=>{const t=e;return{id:Number(t.id||0),pn:String(t.pn||"-"),source:String(t.source||"-"),page:Number(t.page||0)}}).filter(e=>Number.isFinite(e.id)&&e.id>0):[]}function f(r){window.localStorage.setItem(o,JSON.stringify(r.slice(0,200)))}function l(){window.localStorage.setItem("ipc_storage_schema","v2")}export{d as a,m as b,l as m,g as r,f as w};
