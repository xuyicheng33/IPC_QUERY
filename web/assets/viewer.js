import{a as b,r as o,j as e,B as c,A as j,C as N,c as v,R as S}from"./chunks/Card.js";import{I as y}from"./chunks/Input.js";import{S as C}from"./chunks/Select.js";import{C as P}from"./chunks/chevron-right.js";import{F as R,R as $}from"./chunks/refresh-cw.js";const k=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],E=b("chevron-left",k);function p(n,a){const t=Number.parseInt(String(n||""),10);return Number.isFinite(t)&&t>0?t:a}function f(n,a){const t=Number.parseFloat(String(n||""));return Number.isFinite(t)&&t>0?t:a}const F=[1,1.5,2,3,4];function L(){const n=o.useMemo(()=>new URLSearchParams(window.location.search||""),[]),a=String(n.get("pdf")||""),t=!!a.trim(),m=encodeURIComponent(a),[r,d]=o.useState(()=>p(n.get("page"),1)),[i,u]=o.useState(()=>f(n.get("scale"),2)),[g,x]=o.useState("");o.useEffect(()=>{const s=new URLSearchParams;a&&s.set("pdf",a),s.set("page",String(r)),i!==2&&s.set("scale",String(i)),history.replaceState(null,"",`${window.location.pathname}?${s.toString()}`)},[a,r,i]),o.useEffect(()=>{const s=h=>{t&&(h.key==="ArrowLeft"&&d(l=>Math.max(1,l-1)),h.key==="ArrowRight"&&d(l=>l+1))};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[t]);const w=`/render/${m}/${r}.png?scale=${encodeURIComponent(String(i))}`;return e.jsxs("div",{className:"min-h-screen bg-bg text-text",children:[e.jsx("header",{className:"sticky top-0 z-20 border-b border-border bg-surface",children:e.jsxs("div",{className:"mx-auto flex min-h-16 w-full max-w-[1360px] flex-wrap items-center justify-between gap-3 px-4 py-2 md:px-6",children:[e.jsx("div",{className:"text-sm font-medium",children:t?`页预览：${a}`:"页预览（缺少 pdf 参数）"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(c,{variant:"ghost",className:"gap-1.5",onClick:()=>{if(window.history.length>1){window.history.back();return}window.location.href="/"},children:[e.jsx(j,{className:"h-4 w-4","aria-hidden":"true"}),"返回上一级"]}),e.jsxs(c,{variant:"ghost",className:"gap-1.5",disabled:!t,onClick:()=>d(s=>Math.max(1,s-1)),children:[e.jsx(E,{className:"h-4 w-4","aria-hidden":"true"}),"上一页"]}),e.jsx(y,{type:"number",min:1,step:1,className:"w-[92px]",value:r,onChange:s=>d(Math.max(1,p(s.target.value,r))),disabled:!t,"aria-label":"页码"}),e.jsxs(c,{variant:"ghost",className:"gap-1.5",disabled:!t,onClick:()=>d(s=>s+1),children:["下一页",e.jsx(P,{className:"h-4 w-4","aria-hidden":"true"})]}),e.jsx(C,{className:"w-[96px]",value:String(i),onChange:s=>u(f(s.target.value,2)),disabled:!t,"aria-label":"缩放",children:F.map(s=>e.jsxs("option",{value:s,children:["x",s]},s))}),e.jsx("a",{href:t?`/pdf/${m}?p=${r}#page=${r}`:void 0,target:"_blank",rel:"noreferrer",children:e.jsxs(c,{variant:"ghost",className:"gap-2",disabled:!t,children:[e.jsx(R,{className:"h-4 w-4","aria-hidden":"true"}),"原 PDF"]})})]})]})}),e.jsx("main",{className:"mx-auto w-full max-w-[1360px] px-4 py-6 md:px-6",children:e.jsx(N,{children:t?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:w,alt:"PDF page preview",className:"w-full rounded-md border border-border bg-surface-soft",onLoad:()=>{x(`${a} · 第 ${r} 页 · x${i}`)},onError:()=>{x("预览加载失败：可能页码超出范围，或 PDF 未找到")}}),e.jsxs("div",{className:"mt-3 flex items-center gap-2 text-xs text-muted",children:[e.jsx($,{className:"h-3.5 w-3.5","aria-hidden":"true"}),g||"加载中..."]})]}):e.jsx("div",{className:"rounded-md border border-dashed border-border bg-surface-soft px-6 py-8 text-sm text-muted",children:"缺少 `pdf` 参数，请从零件详情页进入预览。"})})})]})}v.createRoot(document.getElementById("root")).render(e.jsx(S.StrictMode,{children:e.jsx(L,{})}));
