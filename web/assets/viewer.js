import{c as b,r as i,j as e,B as l,C as j,a as N,R as S}from"./chunks/Card.js";import{I as v}from"./chunks/Input.js";import{S as y}from"./chunks/Select.js";import{C}from"./chunks/chevron-right.js";import{F as P,R}from"./chunks/refresh-cw.js";const $=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],E=b("chevron-left",$);function h(n,a){const s=Number.parseInt(String(n||""),10);return Number.isFinite(s)&&s>0?s:a}function u(n,a){const s=Number.parseFloat(String(n||""));return Number.isFinite(s)&&s>0?s:a}const F=[1,1.5,2,3,4];function k(){const n=i.useMemo(()=>new URLSearchParams(window.location.search||""),[]),a=String(n.get("pdf")||""),s=!!a.trim(),m=encodeURIComponent(a),[r,d]=i.useState(()=>h(n.get("page"),1)),[o,f]=i.useState(()=>u(n.get("scale"),2)),[g,x]=i.useState("");i.useEffect(()=>{const t=new URLSearchParams;a&&t.set("pdf",a),t.set("page",String(r)),o!==2&&t.set("scale",String(o)),history.replaceState(null,"",`${window.location.pathname}?${t.toString()}`)},[a,r,o]),i.useEffect(()=>{const t=p=>{s&&(p.key==="ArrowLeft"&&d(c=>Math.max(1,c-1)),p.key==="ArrowRight"&&d(c=>c+1))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[s]);const w=`/render/${m}/${r}.png?scale=${encodeURIComponent(String(o))}`;return e.jsxs("div",{className:"min-h-screen bg-bg text-text",children:[e.jsx("header",{className:"sticky top-0 z-20 border-b border-border bg-surface",children:e.jsxs("div",{className:"mx-auto flex min-h-16 w-full max-w-[1360px] flex-wrap items-center justify-between gap-3 px-4 py-2 md:px-6",children:[e.jsx("div",{className:"text-sm font-medium",children:s?`页预览：${a}`:"页预览（缺少 pdf 参数）"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(l,{variant:"ghost",className:"gap-1.5",disabled:!s,onClick:()=>d(t=>Math.max(1,t-1)),children:[e.jsx(E,{className:"h-4 w-4","aria-hidden":"true"}),"上一页"]}),e.jsx(v,{type:"number",min:1,step:1,className:"w-[92px]",value:r,onChange:t=>d(Math.max(1,h(t.target.value,r))),disabled:!s,"aria-label":"页码"}),e.jsxs(l,{variant:"ghost",className:"gap-1.5",disabled:!s,onClick:()=>d(t=>t+1),children:["下一页",e.jsx(C,{className:"h-4 w-4","aria-hidden":"true"})]}),e.jsx(y,{className:"w-[96px]",value:String(o),onChange:t=>f(u(t.target.value,2)),disabled:!s,"aria-label":"缩放",children:F.map(t=>e.jsxs("option",{value:t,children:["x",t]},t))}),e.jsx("a",{href:s?`/pdf/${m}?p=${r}#page=${r}`:void 0,target:"_blank",rel:"noreferrer",children:e.jsxs(l,{variant:"ghost",className:"gap-2",disabled:!s,children:[e.jsx(P,{className:"h-4 w-4","aria-hidden":"true"}),"原 PDF"]})})]})]})}),e.jsx("main",{className:"mx-auto w-full max-w-[1360px] px-4 py-6 md:px-6",children:e.jsx(j,{children:s?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:w,alt:"PDF page preview",className:"w-full rounded-md border border-border bg-surface-soft",onLoad:()=>{x(`${a} · 第 ${r} 页 · x${o}`)},onError:()=>{x("预览加载失败：可能页码超出范围，或 PDF 未找到")}}),e.jsxs("div",{className:"mt-3 flex items-center gap-2 text-xs text-muted",children:[e.jsx(R,{className:"h-3.5 w-3.5","aria-hidden":"true"}),g||"加载中..."]})]}):e.jsx("div",{className:"rounded-md border border-dashed border-border bg-surface-soft px-6 py-8 text-sm text-muted",children:"缺少 `pdf` 参数，请从零件详情页进入预览。"})})})]})}N.createRoot(document.getElementById("root")).render(e.jsx(S.StrictMode,{children:e.jsx(k,{})}));
